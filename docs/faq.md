---
title: å¸¸è§é—®é¢˜
---

## å¦‚ä½•åœæ­¢æ— é™æ¸²æŸ“å¾ªç¯ï¼Ÿ

å¦‚æœæ‚¨ä½¿ç”¨ Reactï¼Œæœ‰ä¸€ä¸ªéå¸¸å¸¸è§çš„é™·é˜±å¯èƒ½å¯¼è‡´æ— é™æ¸²æŸ“ã€‚å¦‚æœæ‚¨æœªèƒ½ä¸º `columns`ã€`data` æˆ– `state` æä¾›ç¨³å®šçš„å¼•ç”¨ï¼ŒReact å°†åœ¨è¡¨æ ¼çŠ¶æ€å‘ç”Ÿä»»ä½•å˜åŒ–æ—¶è¿›å…¥æ— é™é‡æ–°æ¸²æŸ“å¾ªç¯ã€‚

ä¸ºä»€ä¹ˆä¼šå‘ç”Ÿè¿™ç§æƒ…å†µï¼Ÿè¿™æ˜¯ TanStack Table çš„é”™è¯¯å—ï¼Ÿ**ä¸æ˜¯**ï¼Œè¿™ä¸æ˜¯é”™è¯¯ã€‚*è¿™æ˜¯ React å·¥ä½œçš„åŸºæœ¬æ–¹å¼*ï¼Œæ­£ç¡®ç®¡ç†æ‚¨çš„åˆ—ã€æ•°æ®å’ŒçŠ¶æ€å°†é˜²æ­¢è¿™ç§æƒ…å†µå‘ç”Ÿã€‚

TanStack Table è¢«è®¾è®¡ä¸ºåœ¨ä¼ é€’ç»™è¡¨æ ¼çš„ `data` æˆ– `columns` å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæˆ–è€…åœ¨è¡¨æ ¼çš„ä»»ä½•çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶è§¦å‘é‡æ–°æ¸²æŸ“ã€‚

> æœªèƒ½ä¸º `columns` æˆ– `data` æä¾›ç¨³å®šå¼•ç”¨å¯èƒ½å¯¼è‡´æ— é™é‡æ–°æ¸²æŸ“å¾ªç¯ã€‚

### é™·é˜± 1ï¼šåœ¨æ¯æ¬¡æ¸²æŸ“æ—¶åˆ›å»ºæ–°çš„åˆ—æˆ–æ•°æ®

```js
export default function MyComponent() {
  //ğŸ˜µ é”™è¯¯ï¼šè¿™å°†å¯¼è‡´æ— é™é‡æ–°æ¸²æŸ“å¾ªç¯ï¼Œå› ä¸º `columns` åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½è¢«é‡æ–°å®šä¹‰ä¸ºæ–°æ•°ç»„ï¼
  const columns = [
    // ...
  ];

  //ğŸ˜µ é”™è¯¯ï¼šè¿™å°†å¯¼è‡´æ— é™é‡æ–°æ¸²æŸ“å¾ªç¯ï¼Œå› ä¸º `data` åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½è¢«é‡æ–°å®šä¹‰ä¸ºæ–°æ•°ç»„ï¼
  const data = [
    // ...
  ];

  //âŒ åˆ—å’Œæ•°æ®åœ¨ä¸ `useReactTable` ç›¸åŒçš„ä½œç”¨åŸŸä¸­å®šä¹‰ï¼Œæ²¡æœ‰ç¨³å®šçš„å¼•ç”¨ï¼Œå°†å¯¼è‡´æ— é™å¾ªç¯ï¼
  const table = useReactTable({
    columns,
    data,
  });

  return <table>...</table>;
}
```

### è§£å†³æ–¹æ¡ˆ 1ï¼šä½¿ç”¨ useMemo æˆ– useState çš„ç¨³å®šå¼•ç”¨

åœ¨ React ä¸­ï¼Œæ‚¨å¯ä»¥é€šè¿‡åœ¨ç»„ä»¶å¤–éƒ¨/ä¸Šæ–¹å®šä¹‰å˜é‡ï¼Œæˆ–ä½¿ç”¨ `useMemo` æˆ– `useState`ï¼Œæˆ–ä½¿ç”¨ç¬¬ä¸‰æ–¹çŠ¶æ€ç®¡ç†åº“ï¼ˆå¦‚ Redux æˆ– React Query ğŸ˜‰ï¼‰æ¥ä¸ºå˜é‡æä¾›"ç¨³å®š"å¼•ç”¨

```js
//âœ… æ­£ç¡®ï¼šåœ¨ç»„ä»¶å¤–éƒ¨å®šä¹‰åˆ—
const columns = [
  // ...
];

//âœ… æ­£ç¡®ï¼šåœ¨ç»„ä»¶å¤–éƒ¨å®šä¹‰æ•°æ®
const data = [
  // ...
];

// é€šå¸¸åœ¨ç»„ä»¶å†…éƒ¨å®šä¹‰åˆ—å’Œæ•°æ®æ›´å®ç”¨ï¼Œæ‰€ä»¥ä½¿ç”¨ `useMemo` æˆ– `useState` ä¸ºå®ƒä»¬æä¾›ç¨³å®šå¼•ç”¨
export default function MyComponent() {
  //âœ… å¥½ï¼šè¿™ä¸ä¼šå¯¼è‡´æ— é™é‡æ–°æ¸²æŸ“å¾ªç¯ï¼Œå› ä¸º `columns` æ˜¯ç¨³å®šå¼•ç”¨
  const columns = useMemo(() => [
    // ...
  ], []);

  //âœ… å¥½ï¼šè¿™ä¸ä¼šå¯¼è‡´æ— é™é‡æ–°æ¸²æŸ“å¾ªç¯ï¼Œå› ä¸º `data` æ˜¯ç¨³å®šå¼•ç”¨
  const [data, setData] = useState(() => [
    // ...
  ]);

  // åˆ—å’Œæ•°æ®å®šä¹‰åœ¨ç¨³å®šå¼•ç”¨ä¸­ï¼Œä¸ä¼šå¯¼è‡´æ— é™å¾ªç¯ï¼
  const table = useReactTable({
    columns,
    data,
  });

  return <table>...</table>;
}
```

### é™·é˜± 2ï¼šå°±åœ°ä¿®æ”¹åˆ—æˆ–æ•°æ®

å³ä½¿æ‚¨ä¸ºåˆå§‹çš„ `columns` å’Œ `data` æä¾›äº†ç¨³å®šå¼•ç”¨ï¼Œå¦‚æœæ‚¨å°±åœ°ä¿®æ”¹å®ƒä»¬ï¼Œä»ç„¶å¯èƒ½é‡åˆ°æ— é™å¾ªç¯ã€‚è¿™æ˜¯ä¸€ä¸ªå¸¸è§çš„é™·é˜±ï¼Œæ‚¨å¯èƒ½ä¸€å¼€å§‹ä¸ä¼šæ³¨æ„åˆ°è‡ªå·±åœ¨è¿™æ ·åšã€‚åƒå†…è” `data.filter()` è¿™æ ·ç®€å•çš„æ“ä½œï¼Œå¦‚æœä¸å°å¿ƒï¼Œä¹Ÿå¯èƒ½å¯¼è‡´æ— é™å¾ªç¯ã€‚

```js
export default function MyComponent() {
  //âœ… å¥½
  const columns = useMemo(() => [
    // ...
  ], []);

  //âœ… å¥½ï¼ˆReact Query è‡ªåŠ¨ä¸ºæ•°æ®æä¾›ç¨³å®šå¼•ç”¨ï¼‰
  const { data, isLoading } = useQuery({
    //...
  });

  const table = useReactTable({
    columns,
    //âŒ é”™è¯¯ï¼šè¿™å°†å¯¼è‡´æ— é™é‡æ–°æ¸²æŸ“å¾ªç¯ï¼Œå› ä¸º `data` è¢«å°±åœ°ä¿®æ”¹ï¼ˆç ´åäº†ç¨³å®šå¼•ç”¨ï¼‰
    data: data?.filter(d => d.isActive) ?? [],
  });

  return <table>...</table>;
}
```

### è§£å†³æ–¹æ¡ˆ 2ï¼šè®°å¿†åŒ–æ‚¨çš„æ•°æ®è½¬æ¢

ä¸ºäº†é˜²æ­¢æ— é™å¾ªç¯ï¼Œæ‚¨åº”è¯¥å§‹ç»ˆè®°å¿†åŒ–æ‚¨çš„æ•°æ®è½¬æ¢ã€‚è¿™å¯ä»¥é€šè¿‡ `useMemo` æˆ–ç±»ä¼¼æ–¹æ³•æ¥å®Œæˆã€‚

```js
export default function MyComponent() {
  //âœ… å¥½
  const columns = useMemo(() => [
    // ...
  ], []);

  //âœ… å¥½
  const { data, isLoading } = useQuery({
    //...
  });

  //âœ… å¥½ï¼šè¿™ä¸ä¼šå¯¼è‡´æ— é™é‡æ–°æ¸²æŸ“å¾ªç¯ï¼Œå› ä¸º `filteredData` è¢«è®°å¿†åŒ–äº†
  const filteredData = useMemo(() => data?.filter(d => d.isActive) ?? [], [data]);

  const table = useReactTable({
    columns,
    data: filteredData, // ç¨³å®šå¼•ç”¨ï¼
  });

  return <table>...</table>;
}
```

### React Forget

å½“ React Forget å‘å¸ƒæ—¶ï¼Œè¿™äº›é—®é¢˜å¯èƒ½ä¼šæˆä¸ºè¿‡å»ã€‚æˆ–è€…ç›´æ¥ä½¿ç”¨ Solid.js... ğŸ¤“

## å¦‚ä½•é˜»æ­¢æˆ‘çš„è¡¨æ ¼çŠ¶æ€åœ¨æ•°æ®å˜åŒ–æ—¶è‡ªåŠ¨é‡ç½®ï¼Ÿ

å¤§å¤šæ•°æ’ä»¶ä½¿ç”¨çš„çŠ¶æ€åœ¨æ•°æ®æºå˜åŒ–æ—¶_åº”è¯¥_æ­£å¸¸é‡ç½®ï¼Œä½†æœ‰æ—¶å¦‚æœæ‚¨åœ¨å¤–éƒ¨ç­›é€‰æ•°æ®ï¼Œæˆ–åœ¨æŸ¥çœ‹æ•°æ®æ—¶ä¸å¯å˜åœ°ç¼–è¾‘æ•°æ®ï¼Œæˆ–è€…ç®€å•åœ°å¯¹æ•°æ®è¿›è¡Œä»»ä½•å¤–éƒ¨æ“ä½œè€Œä¸å¸Œæœ›è§¦å‘è¡¨æ ¼çŠ¶æ€çš„æŸä¸ªéƒ¨åˆ†è‡ªåŠ¨é‡ç½®ï¼Œæ‚¨éœ€è¦æŠ‘åˆ¶è¿™ç§æƒ…å†µçš„å‘ç”Ÿã€‚

å¯¹äºè¿™äº›æƒ…å†µï¼Œæ¯ä¸ªæ’ä»¶éƒ½æä¾›äº†ä¸€ç§æ–¹æ³•æ¥ç¦ç”¨çŠ¶æ€åœ¨æ•°æ®æˆ–çŠ¶æ€ç‰‡æ®µçš„å…¶ä»–ä¾èµ–é¡¹å‘ç”Ÿå˜åŒ–æ—¶è‡ªåŠ¨å†…éƒ¨é‡ç½®ã€‚é€šè¿‡å°†å…¶ä¸­ä»»ä½•ä¸€ä¸ªè®¾ç½®ä¸º `false`ï¼Œæ‚¨å¯ä»¥é˜»æ­¢è§¦å‘è‡ªåŠ¨é‡ç½®ã€‚

è¿™æ˜¯ä¸€ä¸ªåŸºäº React çš„ç¤ºä¾‹ï¼Œåœ¨æˆ‘ä»¬ç¼–è¾‘è¡¨æ ¼çš„ `data` æºæ—¶ï¼ŒåŸºæœ¬ä¸Šé˜»æ­¢æ¯ä¸ªçŠ¶æ€ç‰‡æ®µåƒé€šå¸¸é‚£æ ·å‘ç”Ÿå˜åŒ–ï¼š

```js
const [data, setData] = React.useState([])
const skipPageResetRef = React.useRef()

const updateData = newData => {
  // å½“ä½¿ç”¨æ­¤å‡½æ•°æ›´æ–°æ•°æ®æ—¶ï¼Œè®¾ç½®ä¸€ä¸ªæ ‡å¿—
  // æ¥ç¦ç”¨æ‰€æœ‰è‡ªåŠ¨é‡ç½®
  skipPageResetRef.current = true

  setData(newData)
}

React.useEffect(() => {
  // è¡¨æ ¼æ›´æ–°åï¼Œå§‹ç»ˆç§»é™¤æ ‡å¿—
  skipPageResetRef.current = false
})

useReactTable({
  ...
  autoResetPageIndex: !skipPageResetRef.current,
  autoResetExpanded: !skipPageResetRef.current,
})
```

ç°åœ¨ï¼Œå½“æˆ‘ä»¬æ›´æ–°æ•°æ®æ—¶ï¼Œä¸Šè¿°è¡¨æ ¼çŠ¶æ€å°†ä¸ä¼šè‡ªåŠ¨é‡ç½®ï¼